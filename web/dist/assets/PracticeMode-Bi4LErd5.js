import{r,j as e,b as me}from"./vendor-react-DpsG3A-O.js";import{u as Ie,a as Pe,p as G,T as Be,C as $e,R as Ve,L as A,c as qe,b as ye,f as Qe}from"./index-DL2fJqf5.js";import{i as fe,g as Ne}from"./visualBonuses-m3ufG0uO.js";import{d as Ce,e as Ue,f as De,T as We,g as Me,E as Ee,h as Re,i as Oe}from"./vendor-lucide-react-DoOgXp02.js";import"./vendor-abs-svg-path-DCUpb6Nw.js";import"./vendor-react-dom-D1u-fJLi.js";import"./vendor-scheduler-CoSDG3-6.js";import"./vendor-firebase-BZrYkTdu.js";import"./vendor-firebase-app-DqcDUDC6.js";import"./vendor-firebase-component-B9jxOSis.js";import"./vendor-firebase-util-CIVODmCg.js";import"./vendor-firebase-logger-CNz1B4Yj.js";import"./vendor-idb-BXWtuYvb.js";import"./vendor-firebase-app-check-Co35-rT3.js";import"./vendor-firebase-firestore-BRp-7IKb.js";import"./vendor-firebase-webchannel-wrapper-QS5lB7L3.js";import"./vendor-firebase-storage-D1N4MLec.js";import"./vendor-firebase-database-DcYXcGm3.js";import"./vendor-react-helmet-async-bvMvt1Ax.js";import"./vendor-react-fast-compare-BCtOC5yC.js";import"./vendor-invariant-DW3JcdOx.js";import"./vendor-shallowequal-Df9Q-7bk.js";import"./vendor-react-router-dom-D6uELkfw.js";import"./vendor-react-router-B_FrsTVh.js";import"./vendor-remix-run-router-9r-WWGj9.js";import"./vendor-mui-material-DksXbHt-.js";import"./vendor-mui-utils-B23qfrSe.js";import"./vendor-clsx-B-dksMZM.js";import"./vendor-mui-system-BndTH9qf.js";import"./vendor-mui-styled-engine-CPmDJbkS.js";import"./vendor-emotion-styled-5vLscvJp.js";import"./vendor-babel-runtime-WXw8LxeR.js";import"./vendor-emotion-serialize-B6qc6euy.js";import"./vendor-emotion-hash-WldOFDRm.js";import"./vendor-emotion-unitless-x5IvBceT.js";import"./vendor-emotion-memoize-3S_6p140.js";import"./vendor-emotion-use-insertion-effect-with-fallbacks-B--OEmuQ.js";import"./vendor-emotion-utils-BijCJQMc.js";import"./vendor-emotion-is-prop-valid-DOnQZHJ6.js";import"./vendor-emotion-react-DrbGOuDy.js";import"./vendor-hoist-non-react-statics-mDtaWys7.js";import"./vendor-react-is-CnyDuYXe.js";import"./vendor-emotion-cache-DvsOMRO7.js";import"./vendor-emotion-sheet-6IwnyhEX.js";import"./vendor-stylis-DDa9OTMq.js";import"./vendor-react-transition-group-Q1VPUTjR.js";import"./vendor-three-CGYwrSEf.js";import"./vendor-katex-DP_4UPSs.js";function Fe(){return e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 40 40",className:"animate-spin",children:[e.jsx("path",{d:"M20 5 Q25 10 20 15 Q15 20 20 25 Q25 30 20 35",stroke:"#3b82f6",strokeWidth:"2",fill:"none",className:"animate-pulse"}),e.jsx("path",{d:"M20 5 Q15 10 20 15 Q25 20 20 25 Q15 30 20 35",stroke:"#3b82f6",strokeWidth:"2",fill:"none",className:"animate-pulse",style:{animationDelay:"0.5s"}})]})})}function Le(l,ne=()=>!0){const _=l.filter(ne);return _.length?_[Math.floor(Math.random()*_.length)]:null}function Ot({questions:l=[],tournamentName:ne=null,lazy:_=null}){const{tournaments:Y,tournamentGroups:v,selectedTournaments:I,setSelectedTournaments:V,selectedCategories:q,setSelectedCategories:y,tournamentGroupsOpen:ge,setTournamentGroupsOpen:J,tournamentVisibleEntriesMainRef:re,handleTournamentToggle:i,validQuestions:Q,categories:ae,inRanges:Z,roundRanges:U,setRoundRanges:xe,roundsByTournament:m,globalNumericRoundMax:D}=Ie({questions:l,lazy:_}),{dark:ie}=Pe(),pe=!!ie,[f,P]=r.useState(!1),[W,E]=r.useState(!1),[B,d]=r.useState(!0),[R,le]=r.useState(()=>{try{const n=localStorage.getItem("sb_leftPaneWidth_practice"),a=Number(n);return Number.isFinite(a)&&a>=220&&a<=720?a:320}catch{return 320}}),L=r.useRef(!1),S=r.useRef(0),O=r.useRef(320);r.useEffect(()=>{function n(c){if(!L.current)return;const z=(c.touches?c.touches[0].clientX:c.clientX)-S.current;let K=Math.round(O.current+z);K=Math.max(220,Math.min(720,K)),le(K)}function a(){if(L.current){L.current=!1;try{localStorage.setItem("sb_leftPaneWidth_practice",String(R))}catch{}document.body.style.cursor="",document.body.style.userSelect=""}}return window.addEventListener("mousemove",n),window.addEventListener("mouseup",a),window.addEventListener("touchmove",n,{passive:!1}),window.addEventListener("touchend",a),()=>{window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",a),window.removeEventListener("touchmove",n),window.removeEventListener("touchend",a)}},[R]);const[F,oe]=r.useState([]),[w,ee]=r.useState(!0),[k,ce]=r.useState(!0),[p,C]=r.useState(!1),[j,h]=r.useState(!1);r.useEffect(()=>{p||h(!1)},[p]);const[T,de]=r.useState(5),N=r.useMemo(()=>{const n=new Set(q);return Q.filter(a=>{if(q.length&&!n.has(a.category)||!Z(a))return!1;const c=a.question_type?.toLowerCase(),g=fe(a);return c==="tossup"?w:c==="bonus"?!k&&!p?!1:p&&j||!k&&p?g:k&&!p?!g:!0:!1})},[Q,q,Z,w,k,p,j]),[b,te]=r.useState(null),[se,$]=r.useState(""),[H,t]=r.useState(""),[o,s]=r.useState(null),[u,M]=r.useState(!1),[x,X]=r.useState(null),[Se,we]=r.useState(!1),he=r.useMemo(()=>{const n=N.some(c=>c.question_type?.toLowerCase()==="tossup"),a=N.some(c=>c.question_type?.toLowerCase()==="bonus");return w&&n?"tossup":a?"bonus":null},[N,w]),ue=r.useMemo(()=>G(b),[b]);function ke(n,a){if(!a)return{correct:!1};const c=String(a.answer??"").trim().toLowerCase(),g=String(n??"").trim().toLowerCase(),z=c.replace(/[()\s.]/g,"").charAt(0),K=G(a),Ae=new Map(K).get(g),be={a:"w",b:"x",c:"y",d:"z"}[z]||z;if(["w","x","y","z"].includes(be)){const je=be===g;return{correct:je,reason:je?void 0:`Correct: ${be.toUpperCase()}`}}const ve=String(Ae??"").toLowerCase().replace(/\s+/g," ").trim(),_e=c.toLowerCase().replace(/\s+/g," ").trim();return{correct:!!ve&&ve===_e}}async function Te(){we(!0);try{let n;const a=b?.question_type?.toLowerCase()==="tossup",c=String(H||"").trim();if(ue.length>0&&!(a&&c.length>0))n=ke(se,b);else{const g=ue.length>0&&a&&c.length>0,z={userAnswer:ue.length>0&&a&&c.length>0?H:se,correctAnswer:b.answer,question:b.question};g&&(z.choices=ue),n=await(g?await qe(z):await ye(z)).json()}if(s(n),n.correct&&a){const g=Qe(b,N);g&&X({bonus:g,userAnswer:"",result:null,showAnswer:!1})}}catch{s({correct:!1,reason:"Check failed"})}finally{we(!1)}}async function ze(){if(x)try{const n=G(x.bonus);let a;n.length>0?a=ke(x.userAnswer,x.bonus):a=await(await ye({userAnswer:x.userAnswer,correctAnswer:x.bonus.answer,question:x.bonus.question})).json(),X(c=>({...c,result:a}))}catch{X(a=>({...a,result:{correct:!1,reason:"Check failed"}}))}}return e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"relative z-10 grid gap-6 w-full md:grid-cols-[var(--left-pane-w)_minmax(0,1fr)]",style:{"--left-pane-w":f&&!W?"25px":`${R}px`},children:[e.jsxs("div",{className:"md:self-start relative",children:[f&&e.jsx("div",{className:"absolute inset-0 z-5",onMouseEnter:()=>E(!0),onMouseLeave:()=>E(!1)}),e.jsx("button",{className:"absolute top-2 -right-2 bg-white dark:bg-darkcard border border-black/10 dark:border-white/20 rounded-full p-1 shadow hover:bg-gray-50 dark:hover:bg-white/10 transition z-10",onClick:()=>{f||!B?(P(!1),d(!0)):(d(!1),P(!0))},onMouseEnter:()=>E(!0),onMouseLeave:()=>E(!1),title:f?"Expand panel":B?"Unpin panel":"Pin panel",children:f?W?e.jsx(Ce,{className:"h-4 w-4"}):e.jsx(Ue,{className:"h-4 w-4 transition-transform rotate-180"}):B?e.jsx(De,{className:"h-4 w-4"}):e.jsx(Ce,{className:"h-4 w-4"})}),e.jsxs("div",{className:`glass p-6 space-y-6 bg-white/80 dark:bg-darkcard/70 backdrop-blur transition-all duration-300 ${f&&!W?"opacity-0 pointer-events-none scale-95":"opacity-100 scale-100"}`,onMouseEnter:()=>E(!0),onMouseLeave:()=>E(!1),children:[I.length===0&&e.jsxs("div",{role:"alert","aria-live":"polite",className:"flex items-start gap-2 rounded-lg border-l-4 border-amber-500 bg-amber-50 text-amber-900 dark:border-amber-400 dark:bg-amber-900/20 dark:text-amber-100 px-3 py-2",children:[e.jsx(We,{className:"mt-0.5 h-4 w-4 shrink-0"}),e.jsx("div",{className:"text-sm",children:"No tournaments selected."})]}),e.jsx(Be,{tournaments:Y,tournamentGroups:v,selectedTournaments:I,setSelectedTournaments:V,tournamentGroupsOpen:ge,setTournamentGroupsOpen:J,handleTournamentToggle:i,tournamentVisibleEntriesMainRef:re,isDark:pe,showTournamentModal:!1,setShowTournamentModal:()=>{}}),e.jsx($e,{categories:ae,selectedCategories:q,setSelectedCategories:y}),e.jsx(Ve,{selectedTournaments:I,tournaments:Y,roundRanges:U,setRoundRanges:xe,roundsByTournament:m,globalNumericRoundMax:D}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-2",children:"Question Types"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("label",{className:"chip cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"mr-1",checked:w,onChange:()=>ee(n=>!n)})," Toss-ups"]}),e.jsxs("label",{className:`chip cursor-pointer ${!w&&!k?"ring-1 ring-tint bg-tint/10":""}`,children:[e.jsx("input",{type:"checkbox",className:"mr-1",checked:k,onChange:()=>ce(n=>!n)})," Bonuses"]}),e.jsxs("label",{className:`chip items-center gap-2 cursor-pointer ${k?"":"opacity-50 pointer-events-none"}`,title:k?"Include image-based bonuses":"Enable Bonuses to toggle",style:{alignItems:"center",minWidth:220,justifyContent:"flex-start",flexWrap:"nowrap",display:"inline-flex"},children:[e.jsx("input",{type:"checkbox",className:"mr-1",checked:p,onChange:()=>C(n=>!n),disabled:!k}),e.jsx("span",{children:"Visual bonuses"}),e.jsxs("span",{className:`${p?"":"opacity-50"} ml-1 flex items-center gap-1`,onClick:n=>n.stopPropagation(),title:p?"Only get visual bonuses":"Enable Visual bonuses first",style:{alignItems:"center"},children:[e.jsx("button",{type:"button",role:"switch","aria-checked":j,"aria-label":"Only visual bonuses",disabled:!p,onClick:()=>h(n=>!n),className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-tint/60 ${j?"bg-tint":"bg-black/30 dark:bg-white/30"} ${p?"":"cursor-not-allowed"}`,style:{verticalAlign:"middle"},children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${j?"translate-x-4":"translate-x-1"}`})}),e.jsx("span",{className:"text-[10px] leading-none text-black/60 dark:text-white/60 select-none ml-1",style:{fontWeight:500},children:"only"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-2",children:"Reading speed"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"range",min:1,max:20,step:1,value:T,onChange:n=>de(Number(n.target.value)),"aria-label":"Reading speed in words per second",className:"w-48"}),e.jsxs("div",{className:"text-sm tabular-nums",children:[T," w/s"]})]}),e.jsx("div",{className:"text-xs text-black/60 dark:text-white/60 mt-1",children:"Space to buzz. Enter to check. “n” next, “a” show answer."})]})]}),!f&&e.jsx("div",{role:"separator","aria-orientation":"vertical",title:"Drag to resize",onMouseDown:n=>{f||(L.current=!0,S.current=n.clientX,O.current=R,document.body.style.cursor="col-resize",document.body.style.userSelect="none")},onTouchStart:n=>{if(f)return;const a=n.touches?.[0];a&&(L.current=!0,S.current=a.clientX,O.current=R,document.body.style.cursor="col-resize",document.body.style.userSelect="none")},className:"hidden md:block absolute top-0 -right-5 h-full w-2 cursor-col-resize z-30 transition-colors",children:e.jsx("div",{className:"absolute inset-y-0 left-[-1px] right-[-1px] w-[1px] bg-gray-400 dark:bg-gray-500"})})]}),e.jsxs("div",{className:"min-w-0",children:[b?e.jsx(He,{current:b,setCurrent:n=>{b&&oe(a=>[...a,b]),te(n),$(""),t(""),s(null),M(!1),X(null)},pool:N,preferredType:he,userAnswer:se,setUserAnswer:$,mcTypedAnswer:H,setMcTypedAnswer:t,result:o,setResult:s,showAnswer:u,setShowAnswer:M,bonusState:x,setBonusState:X,check:Te,checkBonus:ze,readingSpeed:T,checking:Se}):e.jsx("div",{className:"glass p-6 bg-white/80 dark:bg-darkcard/70 backdrop-blur",children:N.length?e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsx("div",{children:"Ready to begin."}),e.jsx("button",{className:"btn btn-primary",onClick:()=>{const a=Le(N,he?(c=>c.question_type?.toLowerCase()===he):(()=>!0));a&&(te(a),$(""),t(""),s(null),M(!1),X(null))},children:"Start"})]}):"No questions available. Select tournaments."}),F.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-semibold text-black/60 dark:text-white/60",children:"Previous Questions"}),F.map((n,a)=>e.jsxs("div",{className:"glass p-4 bg-white/80 dark:bg-darkcard/70 backdrop-blur flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-semibold",children:String(n.tournament).toUpperCase()})," • Round ",n.round," • ",n.category,n.question_number&&e.jsxs(e.Fragment,{children:[" • Q",n.question_number]})," • ",n.question_type?.toLowerCase()==="bonus"?"Bonus":"Toss-up"]}),e.jsx("div",{className:"text-sm text-black/60 dark:text-white/60 truncate max-w-[200px]",children:e.jsx(A,{children:n.answer})})]},n.id||a))]})]})]})})}function He({current:l,setCurrent:ne,pool:_,preferredType:Y,userAnswer:v,setUserAnswer:I,mcTypedAnswer:V,setMcTypedAnswer:q,result:y,setResult:ge,showAnswer:J,setShowAnswer:re,bonusState:i,setBonusState:Q,check:ae,checkBonus:Z,readingSpeed:U,checking:xe}){const m=r.useMemo(()=>G(l),[l]),[D,ie]=me.useState(null),[pe,f]=me.useState(!1),[P,W]=me.useState(null),[E,B]=me.useState(!1),[d,R]=r.useState(!1),[le,L]=r.useState(0),[S,O]=r.useState(!0),F=r.useRef(null),oe=r.useRef(null),[w,ee]=r.useState(0),[k,ce]=r.useState(!1),p=r.useMemo(()=>String(l?.question??""),[l?.id]),C=r.useMemo(()=>p.split(/\s+/).filter(Boolean),[p]),j=le>=C.length,h=String(l?.question_type||"").toLowerCase()==="bonus",T=h||d||j;r.useEffect(()=>{if(!l||!S||d||C.length===0)return;const t=Math.max(50,Math.round(1e3/Math.max(1,U))),o=setInterval(()=>{L(s=>s>=C.length?C.length:s+1)},t);return()=>clearInterval(o)},[l?.id,S,d,C.length,U]),r.useEffect(()=>{R(!1),L(0),O(!0),ee(0),ce(!1)},[l?.id]),r.useEffect(()=>{if(!l||m.length===0||!j||d||w>=4)return;const t=Math.max(250,1e3-Math.min(20,U)*25),o=setInterval(()=>{ee(s=>Math.min(4,s+1))},t);return()=>clearInterval(o)},[l?.id,j,m.length,w,U,d]),r.useEffect(()=>{if(!l||m.length===0||!y||w>=4)return;k||ce(!0);const o=setInterval(()=>{ee(s=>s>=4?4:s+1)},150);return()=>clearInterval(o)},[y,l?.id,m.length,w,k]),r.useEffect(()=>{function t(s){return s&&(s.tagName==="INPUT"||s.tagName==="TEXTAREA"||s.isContentEditable)}const o=s=>{const u=s.key,M=s.target;if((u===" "||u==="Spacebar")&&(t(M)||(s.preventDefault(),h?m.length===0&&setTimeout(()=>F.current?.focus(),0):!d&&S&&(R(!0),O(!1),m.length===0&&setTimeout(()=>F.current?.focus(),0)))),u==="Enter"){if(i&&!i.result&&i.userAnswer){s.preventDefault(),Z();return}(m.length>0?(h||d)&&(!h&&d&&String(V).trim().length>0||!!v):T&&String(v).trim().length>0)&&(s.preventDefault(),ae())}if((u==="n"||u==="N")&&!t(M)&&(s.preventDefault(),de()),(u==="a"||u==="A")&&!t(M)&&(s.preventDefault(),re(x=>!x)),!t(M)&&(h||d)&&m.length>0){const x=u.toLowerCase();(x==="w"||x==="x"||x==="y"||x==="z")&&(s.preventDefault(),I(x))}!t(M)&&!h&&d&&m.length>0&&(u==="t"||u==="T")&&(s.preventDefault(),setTimeout(()=>oe.current?.focus(),0))};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[d,S,m.length,T,v,i,V]),r.useEffect(()=>{let t=!1;async function o(){ie(null);const s=l;if(!s||s.question_type?.toLowerCase()!=="bonus"||!fe(s))return;const u=await Ne({tournament:s.tournament,round:s.round,question_number:s.question_number}).catch(()=>null);t||ie(u)}return o(),()=>{t=!0}},[l?.id]),r.useEffect(()=>{let t=!1;async function o(){W(null);const s=i?.bonus;if(!s||!fe(s))return;const u=await Ne({tournament:s.tournament,round:s.round,question_number:s.question_number}).catch(()=>null);t||W(u)}return o(),()=>{t=!0}},[i?.bonus?.id]);function de(){const o=Le(_,Y?(s=>s.question_type?.toLowerCase()===Y):(()=>!0));ne(o)}function N(t){if(!t||typeof t!="object")return null;const o=["explanation","Explanation","rationale","Rationale","solution","Solution","notes","Notes","why"];for(const s of o){const u=t[s];if(typeof u=="string"&&u.trim())return u.trim()}return null}const b=r.useMemo(()=>N(l),[l?.id]),te=r.useMemo(()=>N(i?.bonus),[i?.bonus?.id]),se=String(l.tournament).toUpperCase(),$=h?!0:d,H=r.useMemo(()=>{if(!Array.isArray(m)||m.length===0)return[];const t=new Map(m);return["w","x","y","z"].map(s=>[s,t.get(s)])},[m]);return e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsx("style",{children:`
        /* Keep display-math inline, no big margins */
        .practice-katex .katex-display { margin: 0; }
        .practice-katex .katex-display > .katex { display: inline !important; }

        /* Minimize extra space around inline math */
        .practice-katex .katex { margin-left: 0.05em; margin-right: 0.02em; }
        /* If math is the very first thing in a block, don't indent it */
        .practice-katex > .katex:first-child { margin-left: 0; }
      `}),e.jsxs("div",{className:"glass p-6 bg-white/80 dark:bg-darkcard/70 backdrop-blur",children:[e.jsxs("div",{className:"text-sm text-black/60 dark:text-white/80 mb-2",children:[e.jsx("span",{className:"font-semibold",children:se})," • ","ROUND ",l.round??"—"," • ",l.category,l.question_number!=null&&e.jsxs(e.Fragment,{children:[" • ","Q",l.question_number]}),e.jsx("span",{className:"ml-2 inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-semibold tracking-wide border bg-purple-50 text-purple-700 border-purple-200 dark:bg-purple-900/20 dark:text-purple-200 dark:border-purple-700",children:h?"BONUS":"TOSS-UP"}),e.jsx("span",{className:"ml-2 inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-semibold tracking-wide border bg-blue-50 text-blue-700 border-blue-200 dark:bg-blue-900/20 dark:text-blue-200 dark:border-blue-700",children:m.length>0?"MULTIPLE CHOICE":"SHORT ANSWER"})]}),l?.question_type?.toLowerCase()==="bonus"&&D&&e.jsxs("div",{className:"mb-3",children:[e.jsx("img",{src:D,alt:`Visual bonus${l?.tournament?` • ${l.tournament}`:""}${l?.round?` • Round ${l.round}`:""}${l?.question_number!=null?` • Q${l.question_number}`:""}`,className:"max-h-64 rounded-md border border-black/10 dark:border-white/10 object-contain cursor-zoom-in hover:opacity-95 transition",onClick:()=>f(!0)}),e.jsx("div",{className:"text-xs text-black/60 dark:text-white/60 mt-1",children:"Click image to view full screen"})]}),j?e.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-line practice-katex",children:e.jsx(A,{children:l.question})}):e.jsxs("div",{className:"text-lg leading-relaxed whitespace-pre-line practice-katex",children:[e.jsx(A,{children:C.slice(0,Math.min(le,C.length)).join(" ")}),!d&&e.jsx("div",{className:"mt-2 text-sm text-black/60 dark:text-white/60",children:"Press space to buzz"})]})]}),e.jsxs("div",{className:"glass p-6 bg-white/80 dark:bg-darkcard/70 backdrop-blur flex flex-col justify-between",style:{minHeight:"40vh",width:"100%"},children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Your answer"}),Array.isArray(m)&&m.length>0?e.jsxs("div",{className:"space-y-3 text-lg mb-4",children:[!j&&!d&&!h?e.jsx("div",{className:"text-sm text-black/60 dark:text-white/70",children:"Choices will appear after the question is read."}):H.map(([t,o],s)=>e.jsxs("label",{className:`flex items-baseline gap-2 ${$?"cursor-pointer":"cursor-not-allowed opacity-75"}`,children:[e.jsx("input",{type:"radio",name:`tossup-mc-${l.id}`,value:t,checked:String(v)===String(t),onChange:()=>I(t),className:"accent-tint w-5 h-5",disabled:!$}),e.jsxs("span",{className:"practice-katex",children:[t.toUpperCase(),")"," ",s<w&&o?e.jsx(A,{children:o}):e.jsx("span",{className:"text-black/50 dark:text-white/50",children:"…"})]})]},t)),!h&&d&&e.jsx("input",{className:"w-full rounded-xl border border-black/10 bg-white dark:bg-darkcard text-black dark:text-white px-4 py-3 outline-none focus:ring-2 focus:ring-tint text-lg",value:V,onChange:t=>q(t.target.value),placeholder:"Type your answer (press “t” to focus)",ref:oe,disabled:!$})]}):e.jsx("input",{className:"w-full rounded-xl border border-black/10 bg-white dark:bg-darkcard text-black dark:text-white px-4 py-3 outline-none focus:ring-2 focus:ring-tint text-lg",value:v,onChange:t=>I(t.target.value),placeholder:"Type your answer",ref:F,disabled:!T}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[(()=>{const t=H.length>0?(h||d)&&(!h&&d&&String(V).trim().length>0||!!v):T&&!!v;return e.jsx("button",{className:"btn btn-primary px-3 py-1.5 text-base",onClick:ae,disabled:!t,title:"Check answer",children:e.jsx(Me,{size:16})})})(),e.jsx("button",{className:"btn btn-ghost px-3 py-1.5 text-base",onClick:()=>re(t=>!t),title:J?"Hide answer":"Reveal answer",children:J?e.jsx(Ee,{size:16}):e.jsx(Re,{size:16})}),e.jsx("button",{className:"btn btn-ghost px-3 py-1.5 text-base",onClick:de,title:"Next question",children:e.jsx(Oe,{size:16})})]}),xe?e.jsxs("div",{className:"mt-4 rounded-xl px-4 py-3 border bg-blue-100 text-blue-900 border-blue-200 dark:bg-blue-900/20 dark:text-blue-100 dark:border-blue-800 flex items-center gap-3",children:[e.jsx(Fe,{}),e.jsx("span",{className:"font-medium",children:"Checking answer..."})]}):y&&e.jsxs("div",{className:"mt-4 rounded-xl px-4 py-3 border "+(y.correct?"bg-green-100 text-green-900 border-green-200 dark:bg-green-900/20 dark:text-green-100 dark:border-green-800":"bg-red-100 text-red-900 border-red-200 dark:bg-red-900/20 dark:text-red-100 dark:border-red-800"),children:[y.correct?"Correct":"Incorrect",y.reason?e.jsx("div",{className:"text-sm text-black/70 dark:text-white/80",children:y.reason}):null,!y.correct&&b&&e.jsxs("div",{className:"mt-2 text-sm text-black/80 dark:text-white/80 whitespace-pre-line",children:[e.jsx("span",{className:"font-semibold",children:"Explanation:"})," ",b]})]}),J&&e.jsxs("div",{className:"mt-4 rounded-xl bg-black/5 dark:bg-white/10 px-4 py-3",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-black/60 dark:text-white/60",children:"ANSWER"}),e.jsx("div",{className:"font-medium text-black dark:text-white",children:e.jsx(A,{children:l.answer.toUpperCase()})})]}),i&&e.jsxs("div",{className:"mt-8 border-t pt-6",children:[e.jsx("div",{className:"font-semibold mb-2",children:"Bonus"}),P&&e.jsxs("div",{className:"mb-3",children:[e.jsx("img",{src:P,alt:`Visual bonus${i?.bonus?.tournament?` • ${i.bonus.tournament}`:""}${i?.bonus?.round?` • Round ${i.bonus.round}`:""}${i?.bonus?.question_number!=null?` • Q${i.bonus.question_number}`:""}`,className:"max-h-64 rounded-md border border-black/10 dark:border-white/10 object-contain cursor-zoom-in hover:opacity-95 transition",onClick:()=>B(!0)}),e.jsx("div",{className:"text-xs text-black/60 dark:text-white/60 mt-1",children:"Click image to view full screen"})]}),e.jsx("div",{className:"mb-2 whitespace-pre-line text-lg practice-katex",children:e.jsx(A,{children:i.bonus.question})}),G(i.bonus).length>0?e.jsx("div",{className:"space-y-2 text-lg mb-4",children:G(i.bonus).map(([t,o])=>e.jsxs("label",{className:"flex items-baseline gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:`bonus-mc-${i.bonus.id}`,value:t,checked:String(i.userAnswer)===String(t),onChange:()=>Q(s=>({...s,userAnswer:t})),className:"accent-tint w-5 h-5",disabled:!!i.result}),e.jsxs("span",{className:"practice-katex",children:[t.toUpperCase(),") ",e.jsx(A,{children:o})]})]},t))}):e.jsx("input",{className:"w-full rounded-xl border border-black/10 bg-white dark:bg-darkcard text-black dark:text-white px-4 py-3 outline-none focus:ring-2 focus:ring-tint text-lg",value:i.userAnswer,onChange:t=>Q(o=>({...o,userAnswer:t.target.value})),placeholder:"Type your answer",disabled:!!i.result}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{className:"btn btn-primary px-3 py-1.5 text-base",onClick:Z,disabled:!i.userAnswer||!!i.result,title:"Check answer",children:e.jsx(Me,{size:16})}),e.jsx("button",{className:"btn btn-ghost px-3 py-1.5 text-base",onClick:()=>Q(t=>({...t,showAnswer:!t.showAnswer})),title:i.showAnswer?"Hide answer":"Reveal answer",children:i.showAnswer?e.jsx(Ee,{size:16}):e.jsx(Re,{size:16})})]}),i.result&&e.jsxs("div",{className:"mt-4 rounded-xl px-4 py-3 border "+(i.result.correct?"bg-green-100 text-green-900 border-green-200 dark:bg-green-900/20 dark:text-green-100 dark:border-green-800":"bg-red-100 text-red-900 border-red-200 dark:bg-red-900/20 dark:text-red-100 dark:border-red-800"),children:[i.result.correct?"Correct":"Incorrect",i.result.reason?e.jsx("div",{className:"text-sm text-black/70 dark:text-white/80",children:i.result.reason}):null,!i.result.correct&&te&&e.jsxs("div",{className:"mt-2 text-sm text-black/80 dark:text-white/80 whitespace-pre-line",children:[e.jsx("span",{className:"font-semibold",children:"Explanation:"})," ",te]})]}),i.showAnswer&&e.jsxs("div",{className:"mt-4 rounded-xl bg-black/5 dark:bg-white/10 px-4 py-3",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-black/60 dark:text-white/60",children:"Answer"}),e.jsx("div",{className:"font-medium text-black dark:text-white",children:e.jsx(A,{children:i.bonus.answer})})]})]})]}),pe&&D&&e.jsxs("div",{className:"fixed inset-0 z-[90] flex items-center justify-center",role:"dialog","aria-modal":"true","aria-label":"Visual bonus image",children:[e.jsx("div",{className:"absolute inset-0 bg-black/80",onClick:()=>f(!1)}),e.jsxs("div",{className:"relative max-w-[96vw] max-h-[96vh] p-2",children:[e.jsx("img",{src:D,alt:"Visual bonus full screen",className:"max-w-[96vw] max-h-[92vh] object-contain rounded shadow-2xl"}),e.jsx("button",{type:"button",className:"absolute -top-3 -right-3 bg-white text-black rounded-full shadow p-2 hover:bg-white/90 focus:outline-none","aria-label":"Close full screen image",onClick:()=>f(!1),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"h-4 w-4",children:e.jsx("path",{fillRule:"evenodd",d:"M4.22 4.22a.75.75 0 011.06 0L10 8.94l4.72-4.72a.75.75 0 111.06 1.06L11.06 10l4.72 4.72a.75.75 0 11-1.06 1.06L10 11.06l-4.72 4.72a.75.75 0 01-1.06-1.06L8.94 10 4.22 5.28a.75.75 0 010-1.06z",clipRule:"evenodd"})})})]})]}),E&&P&&e.jsxs("div",{className:"fixed inset-0 z-[90] flex items-center justify-center",role:"dialog","aria-modal":"true","aria-label":"Visual bonus image",children:[e.jsx("div",{className:"absolute inset-0 bg-black/80",onClick:()=>B(!1)}),e.jsxs("div",{className:"relative max-w-[96vw] max-h-[96vh] p-2",children:[e.jsx("img",{src:P,alt:"Visual bonus full screen",className:"max-w-[96vw] max-h-[92vh] object-contain rounded shadow-2xl"}),e.jsx("button",{type:"button",className:"absolute -top-3 -right-3 bg-white text-black rounded-full shadow p-2 hover:bg-white/90 focus:outline-none","aria-label":"Close full screen image",onClick:()=>B(!1),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"h-4 w-4",children:e.jsx("path",{fillRule:"evenodd",d:"M4.22 4.22a.75.75 0 011.06 0L10 8.94l4.72-4.72a.75.75 0 111.06 1.06L11.06 10l4.72 4.72a.75.75 0 11-1.06 1.06L10 11.06l-4.72 4.72a.75.75 0 01-1.06-1.06L8.94 10 4.22 5.28a.75.75 0 010-1.06z",clipRule:"evenodd"})})})]})]})]})}export{Ot as default};
