const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PracticeMode-CQy9BS23.js","assets/vendor-react-DpsG3A-O.js","assets/vendor-abs-svg-path-DCUpb6Nw.js","assets/visualBonuses-4DetGzrX.js","assets/vendor-katex-DP_4UPSs.js","assets/vendor-katex-CIur2ABi.css","assets/vendor-firebase-storage-D58QqkYS.js","assets/vendor-firebase-app-C29JXm3G.js","assets/vendor-firebase-component-CtBPhazS.js","assets/vendor-firebase-util-DPJAB8vN.js","assets/vendor-firebase-logger-CNz1B4Yj.js","assets/vendor-idb-BXWtuYvb.js","assets/TournamentSelector-BqHBDHES.js","assets/vendor-lucide-react-Lx6fY6Gz.js","assets/vendor-react-dom-D1u-fJLi.js","assets/vendor-scheduler-CoSDG3-6.js","assets/vendor-firebase-ij0QPQ9d.js","assets/vendor-firebase-firestore-BGkxm74f.js","assets/vendor-firebase-webchannel-wrapper-QS5lB7L3.js","assets/vendor-mui-material-DksXbHt-.js","assets/vendor-mui-utils-B23qfrSe.js","assets/vendor-clsx-B-dksMZM.js","assets/vendor-mui-system-BndTH9qf.js","assets/vendor-mui-styled-engine-CPmDJbkS.js","assets/vendor-emotion-styled-5vLscvJp.js","assets/vendor-babel-runtime-WXw8LxeR.js","assets/vendor-emotion-serialize-B6qc6euy.js","assets/vendor-emotion-hash-WldOFDRm.js","assets/vendor-emotion-unitless-x5IvBceT.js","assets/vendor-emotion-memoize-3S_6p140.js","assets/vendor-emotion-use-insertion-effect-with-fallbacks-B--OEmuQ.js","assets/vendor-emotion-utils-BijCJQMc.js","assets/vendor-emotion-is-prop-valid-DOnQZHJ6.js","assets/vendor-emotion-react-DrbGOuDy.js","assets/vendor-hoist-non-react-statics-mDtaWys7.js","assets/vendor-react-is-CnyDuYXe.js","assets/vendor-emotion-cache-DvsOMRO7.js","assets/vendor-emotion-sheet-6IwnyhEX.js","assets/vendor-stylis-DDa9OTMq.js","assets/vendor-react-transition-group-Q1VPUTjR.js","assets/vendor-react-router-dom-D-i9eXTo.js","assets/vendor-react-router-D4SgS1v_.js","assets/vendor-remix-run-router-9r-WWGj9.js","assets/vendor-react-helmet-async-bvMvt1Ax.js","assets/vendor-react-fast-compare-BCtOC5yC.js","assets/vendor-invariant-DW3JcdOx.js","assets/vendor-shallowequal-Df9Q-7bk.js","assets/Admin-BewFQqRd.js","assets/RoundGenerator-taxQ471E.js","assets/vendor-react-pdf-renderer-DfOTdHag.js","assets/vendor-queue-IZnSDwnG.js","assets/vendor-inherits-BICa84dG.js","assets/vendor-events-DQ172AOg.js","assets/vendor-react-pdf-font-ByacAZ2x.js","assets/vendor-cross-fetch-DvOI2u39.js","assets/vendor-fontkit-5mDwoQ7O.js","assets/vendor-restructure-DwIbRzqP.js","assets/vendor-swc-helpers-DIxjOVuh.js","assets/vendor-fast-deep-equal-DtIvihjZ.js","assets/vendor-unicode-properties-BbL32wKl.js","assets/vendor-base64-js-BJmSPyJr.js","assets/vendor-unicode-trie-rSh8NucD.js","assets/vendor-tiny-inflate-BmeP50H3.js","assets/vendor-dfa-DFRa2UL2.js","assets/vendor-clone-DniFCc4t.js","assets/vendor-brotli-CUuIRSoC.js","assets/vendor-tslib-kHcLnhpD.js","assets/vendor-react-pdf-render-DYs5yDRr.js","assets/vendor-react-pdf-primitives-B6ApagcG.js","assets/vendor-react-pdf-fns-DIcDsgsD.js","assets/vendor-parse-svg-path-Bi0KIs1g.js","assets/vendor-normalize-svg-path-CFWHe3yZ.js","assets/vendor-svg-arc-to-cubic-bezier-DEq50KMd.js","assets/vendor-color-string-BKSasjlw.js","assets/vendor-color-name-Dju3oUBS.js","assets/vendor-simple-swizzle-3gX0Onlb.js","assets/vendor-is-arrayish-DyGeW-O8.js","assets/vendor-react-pdf-pdfkit-CgWEQEi-.js","assets/vendor-pako-CNe1bWpJ.js","assets/vendor-crypto-js-C9XMI5TL.js","assets/vendor-jay-peg-DnV82Tak.js","assets/vendor-react-pdf-png-js-D_OjzuBh.js","assets/vendor-react-pdf-layout-CVT9JNgr.js","assets/vendor-react-pdf-stylesheet-B2kC1IpU.js","assets/vendor-postcss-value-parser-DOXmp8r9.js","assets/vendor-hsl-to-hex-CDkcI7Vq.js","assets/vendor-hsl-to-rgb-for-reals-jL61FXS_.js","assets/vendor-media-engine-BWjc9dwl.js","assets/vendor-react-pdf-textkit-R3VqYnwu.js","assets/vendor-bidi-js-DLACMwmw.js","assets/vendor-hyphen-B2aENclZ.js","assets/vendor-yoga-layout-nAHjiEuJ.js","assets/vendor-react-pdf-image-BJ1YGwqv.js","assets/vendor-object-assign-Dm9xdUEz.js"])))=>i.map(i=>d[i]);
import{r as w,j as t,b as C}from"./vendor-react-DpsG3A-O.js";import{c as ge}from"./vendor-react-dom-D1u-fJLi.js";import{g as we,o as xe,G as be,s as ye,a as je,c as ve,b as ke,d as Se}from"./vendor-firebase-ij0QPQ9d.js";import{g as Ne,a as B,d as k,c as ie,b as Ee,s as _,u as S,e as M,f as Le,h as Ae,i as ne}from"./vendor-firebase-firestore-BGkxm74f.js";import{c as oe,i as De}from"./vendor-firebase-app-C29JXm3G.js";import"./vendor-firebase-logger-CNz1B4Yj.js";import{g as Re}from"./vendor-firebase-storage-D58QqkYS.js";import{s as Pe,S as Ce}from"./vendor-mui-material-DksXbHt-.js";import{L as ce,c as Oe,R as _e}from"./vendor-react-router-dom-D-i9eXTo.js";import{H as Y,a as Me}from"./vendor-react-helmet-async-bvMvt1Ax.js";import{d as Be,c as Ie,f as Te}from"./vendor-react-router-D4SgS1v_.js";import{U as $e,H as qe}from"./vendor-lucide-react-Lx6fY6Gz.js";import"./vendor-abs-svg-path-DCUpb6Nw.js";import"./vendor-scheduler-CoSDG3-6.js";import"./vendor-firebase-util-DPJAB8vN.js";import"./vendor-firebase-component-CtBPhazS.js";import"./vendor-firebase-webchannel-wrapper-QS5lB7L3.js";import"./vendor-idb-BXWtuYvb.js";import"./vendor-mui-utils-B23qfrSe.js";import"./vendor-clsx-B-dksMZM.js";import"./vendor-mui-system-BndTH9qf.js";import"./vendor-mui-styled-engine-CPmDJbkS.js";import"./vendor-emotion-styled-5vLscvJp.js";import"./vendor-babel-runtime-WXw8LxeR.js";import"./vendor-emotion-serialize-B6qc6euy.js";import"./vendor-emotion-hash-WldOFDRm.js";import"./vendor-emotion-unitless-x5IvBceT.js";import"./vendor-emotion-memoize-3S_6p140.js";import"./vendor-emotion-use-insertion-effect-with-fallbacks-B--OEmuQ.js";import"./vendor-emotion-utils-BijCJQMc.js";import"./vendor-emotion-is-prop-valid-DOnQZHJ6.js";import"./vendor-emotion-react-DrbGOuDy.js";import"./vendor-hoist-non-react-statics-mDtaWys7.js";import"./vendor-react-is-CnyDuYXe.js";import"./vendor-emotion-cache-DvsOMRO7.js";import"./vendor-emotion-sheet-6IwnyhEX.js";import"./vendor-stylis-DDa9OTMq.js";import"./vendor-react-transition-group-Q1VPUTjR.js";import"./vendor-remix-run-router-9r-WWGj9.js";import"./vendor-react-fast-compare-BCtOC5yC.js";import"./vendor-invariant-DW3JcdOx.js";import"./vendor-shallowequal-Df9Q-7bk.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}})();const ze="modulepreload",Fe=function(e){return"/"+e},ae={},Z=function(s,n,o){let r=Promise.resolve();if(n&&n.length>0){let a=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),c=i?.nonce||i?.getAttribute("nonce");r=a(n.map(d=>{if(d=Fe(d),d in ae)return;ae[d]=!0;const u=d.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${m}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":ze,u||(f.as="script"),f.crossOrigin="",f.href=d,c&&f.setAttribute("nonce",c),document.head.appendChild(f),u)return new Promise((h,x)=>{f.addEventListener("load",h),f.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${d}`)))})}))}function l(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return r.then(i=>{for(const c of i||[])c.status==="rejected"&&l(c.reason);return s().catch(l)})},We={apiKey:"AIzaSyC-4y146WLvcjfTg1IrnRgpLJGLir3Kv6E",authDomain:"sciencebowl.org",projectId:"scibowl-analytics",storageBucket:"scibowl-analytics.firebasestorage.app",messagingSenderId:"579454885012",appId:"1:579454885012:web:2015104d8f5e3a6a302881"};let J;function ee(){return oe().length?J=oe()[0]:J=De(We),J}function N(){return Ne(ee())}function T(){return we(ee())}function Vt(){return Re(ee())}function Ue(e={}){const s=e.roundSubcollection||"rounds",[n,o]=w.useState([]),[r,l]=w.useState(!0),[i,c]=w.useState(null),[a,d]=w.useState(!1),[u,m]=w.useState(null),f=w.useRef(new Map),h=7200*60*1e3,x=w.useRef(null);function A(){return new Promise((p,y)=>{if(x.current)return p(x.current);const b=indexedDB.open("scibowl-rounds-cache",1);b.onupgradeneeded=()=>{const v=b.result;v.objectStoreNames.contains("rounds")||v.createObjectStore("rounds")},b.onsuccess=()=>{x.current=b.result,p(b.result)},b.onerror=()=>y(b.error)})}async function P(p){try{const y=await A();return await new Promise((b,v)=>{const E=y.transaction("rounds","readonly").objectStore("rounds").get(p);E.onsuccess=()=>b(E.result||null),E.onerror=()=>v(E.error)})}catch{return null}}async function O(p,y){try{const b=await A();await new Promise((v,j)=>{const q=b.transaction("rounds","readwrite").objectStore("rounds").put(y,p);q.onsuccess=()=>v(),q.onerror=()=>j(q.error)})}catch{}}w.useEffect(()=>{let p=!1;return(async()=>{try{l(!0);const y=await P("meta:tournaments");y&&!p&&o(y.list||[]);const b=N(),v=await B(k(b,"meta","tournaments"));if(!v.exists())throw new Error("meta/tournaments document not found");const j=v.data().list||[];p||o(j),O("meta:tournaments",{list:j,updatedAt:Date.now()})}catch(y){p||c(y)}finally{p||l(!1)}})(),()=>{p=!0}},[]);async function G(p,{force:y=!1}={}){const b=(p||[]).filter(Boolean);if(b.length===0)return;d(!0),m(null);const v=N();try{for(const j of b){if(f.current.get(j)&&!y)continue;const E=await P(`t:${j}`),q=E&&typeof E.updatedAt=="number"&&Date.now()-E.updatedAt<=h;if(E&&q&&!y){f.current.set(j,E.payload);continue}const me=ie(v,"tournaments",j,s),fe=await Ee(me),V={},F=[];fe.forEach(re=>{const z=re.data(),I=re.id;V[I]={id:I,...z};const he=Array.isArray(z.tossups)?z.tossups:[],pe=Array.isArray(z.bonuses)?z.bonuses:[];for(const L of he){const Q=L._origId||L.origId||L.id;F.push({...L,id:Q||`${j}__${I}__tu__${L.question_number}`,tournament:j,round:I})}for(const L of pe){const Q=L._origId||L.origId||L.id;F.push({...L,id:Q||`${j}__${I}__bo__${L.question_number}`,tournament:j,round:I})}}),f.current.set(j,{rounds:V,flatQuestions:F}),O(`t:${j}`,{payload:{rounds:V,flatQuestions:F},updatedAt:Date.now()})}}catch(j){m(j)}finally{d(!1)}}function H(p){const y=[];for(const b of p||[]){const v=f.current.get(b);v?.flatQuestions&&y.push(...v.flatQuestions)}return y}function g(p){const y=f.current.get(p);return y?Object.values(y.rounds).sort((b,v)=>b.round?.localeCompare?.(v.round||"")||0):[]}return{tournaments:n,loadingTournaments:r,errorTournaments:i,loading:a,error:u,ensureLoaded:G,getLoadedQuestions:H,getRounds:g}}const Ge=Pe(Ce)(({theme:e})=>({width:62,height:34,padding:7,"& .MuiSwitch-switchBase":{margin:1,padding:0,transform:"translateX(6px)","&.Mui-checked":{color:"#fff",transform:"translateX(22px)","& .MuiSwitch-thumb:before":{backgroundImage:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 20 20"><path fill="%23fff" d="M4.2 2.5l-.7 1.8-1.8.7 1.8.7.7 1.8.6-1.8L6.7 5l-1.9-.7-.6-1.8zm15 8.3a6.7 6.7 0 11-6.6-6.6 5.8 5.8 0 006.6 6.6z"/></svg>')`},"& + .MuiSwitch-track":{opacity:1,backgroundColor:e.palette.mode==="dark"?"#8796A5":"#aab4be"}}},"& .MuiSwitch-thumb":{backgroundColor:e.palette.mode==="dark"?"#003892":"#001e3c",width:32,height:32,"&::before":{content:"''",position:"absolute",width:"100%",height:"100%",left:0,top:0,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundImage:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 20 20"><path fill="%23fff" d="M9.305 1.667V3.75h1.389V1.667h-1.39zm-4.707 1.95l-.982.982L5.09 6.072l.982-.982-1.473-1.473zm10.802 0L13.927 5.09l.982.982 1.473-1.473-.982-.982zM10 5.139a4.872 4.872 0 00-4.862 4.86A4.872 4.872 0 0010 14.862 4.872 4.872 0 0014.86 10 4.872 4.872 0 0010 5.139zm0 1.389A3.462 3.462 0 0113.471 10a3.462 3.462 0 01-3.473 3.472A3.462 3.462 0 016.527 10 3.462 3.462 0 0110 6.528zM1.665 9.305v1.39h2.083v-1.39H1.666zm14.583 0v1.39h2.084v-1.39h-2.084zM5.09 13.928L3.616 15.4l.982.982 1.473-1.473-.982-.982zm9.82 0l-.982.982 1.473 1.473.982-.982-1.473-1.473zM9.305 16.25v2.083h1.389V16.25h-1.39z"/></svg>')`}},"& .MuiSwitch-track":{opacity:1,backgroundColor:e.palette.mode==="dark"?"#8796A5":"#aab4be",borderRadius:20/2}}));function le({checked:e,onChange:s,label:n}){const o=w.useCallback(()=>{s(!e)},[e,s]);return t.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:12},children:[t.jsx(Ge,{checked:e,onChange:r=>s(r.target.checked),inputProps:{"aria-label":"Toggle dark mode"}}),n?t.jsx("button",{type:"button",onClick:o,style:{border:"none",background:"transparent",padding:0,margin:0,color:"inherit",font:"inherit",cursor:"pointer",display:"inline-flex",alignItems:"center"},children:n}):null]})}const He="scibowl-user-cache",Ve=1;let W=null;const de=7200*60*1e3;function $(){return W||(W=new Promise((e,s)=>{const n=indexedDB.open(He,Ve);n.onupgradeneeded=()=>{const o=n.result;o.objectStoreNames.contains("roundsIndex")||o.createObjectStore("roundsIndex"),o.objectStoreNames.contains("roundDetails")||o.createObjectStore("roundDetails")},n.onsuccess=()=>e(n.result),n.onerror=()=>s(n.error)}),W)}async function D(e){try{const s=await $();return await new Promise((n,o)=>{const i=s.transaction("roundsIndex","readonly").objectStore("roundsIndex").get(e);i.onsuccess=()=>n(i.result||null),i.onerror=()=>o(i.error)})}catch{return null}}async function R(e,s){try{const n=await $();await new Promise((o,r)=>{const c=n.transaction("roundsIndex","readwrite").objectStore("roundsIndex").put(s,e);c.onsuccess=()=>o(),c.onerror=()=>r(c.error)})}catch{}}async function te(e,s){try{const n=await $();return await new Promise((o,r)=>{const c=n.transaction("roundDetails","readonly").objectStore("roundDetails").get(`${e}::${s}`);c.onsuccess=()=>o(c.result||null),c.onerror=()=>r(c.error)})}catch{return null}}async function U(e,s,n){try{const o=await $();await new Promise((r,l)=>{const a=o.transaction("roundDetails","readwrite").objectStore("roundDetails").put(n,`${e}::${s}`);a.onsuccess=()=>r(),a.onerror=()=>l(a.error)})}catch{}}async function Qe(e,s){try{const n=await $();await new Promise(o=>{const i=n.transaction("roundDetails","readwrite").objectStore("roundDetails").delete(`${e}::${s}`);i.onsuccess=()=>o(),i.onerror=()=>o()})}catch{}}async function Je(e){try{const s=await $();await new Promise((n,o)=>{const r=s.transaction(["roundsIndex","roundDetails"],"readwrite"),l=r.objectStore("roundsIndex"),i=r.objectStore("roundDetails"),c=l.delete(e);c.onerror=()=>o(c.error),c.onsuccess=()=>{const a=i.getAllKeys();a.onsuccess=()=>{const d=(a.result||[]).filter(m=>typeof m=="string"&&m.startsWith(`${e}::`));let u=d.length;if(u===0){n();return}d.forEach(m=>{const f=i.delete(m);f.onsuccess=()=>{--u===0&&n()},f.onerror=()=>{--u===0&&n()}})},a.onerror=()=>n()}})}catch{}}async function Qt(e,s){if(!e)throw new Error("Not authenticated");const n=N(),o=ie(n,"users",e,"rounds"),r=await Ae(o,{...s,createdAt:ne()}),l=k(n,"users",e,"meta","roundsIndex"),i={title:s.title,count:s.count,createdAt:ne()};await _(l,{entries:{[r.id]:i}},{merge:!0});try{const c=Math.floor(Date.now()/1e3),a=await D(e),d=a?.entries?{...a.entries}:{};d[r.id]={title:s.title,count:s.count,createdAt:{seconds:c}},await R(e,{entries:d,updatedAt:Date.now()}),await U(e,r.id,{data:{id:r.id,...s,createdAt:{seconds:c}},updatedAt:Date.now()})}catch{}return r.id}async function Jt(e,{force:s=!1}={}){if(!e)return[];if(!s){const d=await D(e);if(d&&d.entries&&!(typeof d.updatedAt=="number"?Date.now()-d.updatedAt>de:!0)){const m=Object.entries(d.entries).map(([f,h])=>({id:f,...h}));return m.sort((f,h)=>(h.createdAt?.seconds||0)-(f.createdAt?.seconds||0)),m}}const n=N(),o=k(n,"users",e,"meta","roundsIndex"),r=await B(o);if(!r.exists())return await R(e,{entries:{},updatedAt:Date.now()}),[];const l=r.data()||{};let i=l.entries||{};const c=l.folders||{};if(!i||Object.keys(i).length===0){const d={};for(const[u,m]of Object.entries(l))if(u.startsWith("entries.")){const f=u.slice(8);f&&(d[f]=m)}Object.keys(d).length>0&&(i=d)}await R(e,{entries:i,folders:c,updatedAt:Date.now()});const a=Object.entries(i).map(([d,u])=>({id:d,...u}));return a.sort((d,u)=>{const m=d.createdAt?.seconds||0;return(u.createdAt?.seconds||0)-m}),a}async function Kt(e,s,{force:n=!1}={}){if(!e||!s)return null;const o=await te(e,s);if(o&&!n&&o&&typeof o=="object"&&"data"in o&&"updatedAt"in o&&!(typeof o.updatedAt=="number"?Date.now()-o.updatedAt>de:!0))return o.data;const r=N(),l=k(r,"users",e,"rounds",s),i=await B(l);if(!i.exists())return null;const c={id:i.id,...i.data()};return await U(e,s,{data:c,updatedAt:Date.now()}),c}async function Xt(e,{force:s=!1}={}){if(!e)return[];if(!s){const a=await D(e),d=a?.folders?Object.keys(a.folders):null;if(d)return d}const n=N(),o=k(n,"users",e,"meta","roundsIndex"),r=await B(o),i=(r.exists()?r.data()||{}:{}).folders||{},c=await D(e);return await R(e,{entries:c?.entries||{},folders:i,updatedAt:Date.now()}),Object.keys(i)}async function Yt(e,s){if(!e)throw new Error("Not authenticated");const n=(s??"").toString().trim();if(!n)throw new Error("Folder name required");const o=N(),r=k(o,"users",e,"meta","roundsIndex");await _(r,{folders:{[n]:!0}},{merge:!0});const l=await D(e),i={...l?.folders||{},[n]:!0};return await R(e,{entries:l?.entries||{},folders:i,updatedAt:Date.now()}),!0}async function Zt(e,s,n){if(!e)throw new Error("Not authenticated");const o=(s??"").toString().trim(),r=(n??"").toString().trim();if(!o)throw new Error("Source folder name required");if(!r)throw new Error("Destination folder name required");if(o===r)return!0;const l=N(),i=k(l,"users",e,"meta","roundsIndex"),c=await B(i);if(!c.exists())throw new Error("No folders meta found");const a=c.data()||{},d={...a.entries||{}},u={...a.folders||{}};if(!u[o])throw new Error("Folder does not exist");if(u[r])throw new Error("A folder with that name already exists");const m={};for(const[h,x]of Object.entries(d))x&&x.folder===o&&(m[`entries.${h}.folder`]=r,d[h]={...x,folder:r});await S(i,{[`folders.${o}`]:M(),[`folders.${r}`]:!0}).catch(async()=>{const h={folders:{[r]:!0}};await _(i,h,{merge:!0})}),Object.keys(m).length>0&&await S(i,m).catch(async()=>{await _(i,{entries:d},{merge:!0})});const f=Object.entries(d).filter(([,h])=>h.folder===r).map(([h])=>h);for(const h of f)try{const x=k(l,"users",e,"rounds",h);await S(x,{folder:r})}catch{}try{const h=await D(e);if(h){const x={...h.folders||{}};delete x[o],x[r]=!0;const A={...h.entries||{}};for(const[P,O]of Object.entries(A))O&&O.folder===o&&(A[P]={...O,folder:r});await R(e,{entries:A,folders:x,updatedAt:Date.now()})}}catch{}return!0}async function es(e,s){if(!e)throw new Error("Not authenticated");const n=(s??"").toString().trim();if(!n)throw new Error("Folder name required");const o=N(),r=k(o,"users",e,"meta","roundsIndex"),l=await B(r);if(!l.exists())return!0;const i=l.data()||{};if(!{...i.folders||{}}[n])return!0;const a={...i.entries||{}},d={};for(const[u,m]of Object.entries(a))m&&m.folder===n&&(d[`entries.${u}.folder`]=M(),delete a[u].folder);try{await S(r,{[`folders.${n}`]:M()})}catch{}if(Object.keys(d).length>0)try{await S(r,d)}catch{await _(r,{entries:a},{merge:!0})}for(const[u,m]of Object.entries(a))if(!m.folder)try{const f=k(o,"users",e,"rounds",u);await S(f,{folder:M()})}catch{}try{const u=await D(e);if(u){const m={...u.folders||{}};delete m[n];const f={...u.entries||{}};for(const[h,x]of Object.entries(f))if(x&&x.folder===n){const{folder:A,...P}=x;f[h]=P}await R(e,{entries:f,folders:m,updatedAt:Date.now()})}}catch{}return!0}async function ts(e,s){if(!e||!s)throw new Error("Missing uid/roundId");const n=N(),o=k(n,"users",e,"rounds",s);try{await Le(o)}catch{}const r=k(n,"users",e,"meta","roundsIndex");try{await S(r,{[`entries.${s}`]:M()})}catch{try{const i=await B(r),a={...(i.exists()?i.data()||{}:{}).entries||{}};s in a&&delete a[s],await _(r,{entries:a},{merge:!0})}catch{}}try{const l=await D(e);if(l?.entries&&s in l.entries){const{[s]:i,...c}=l.entries;await R(e,{entries:c,updatedAt:Date.now()})}await Qe(e,s)}catch{}return!0}async function ss(e,s,n){if(!e||!s)throw new Error("Missing uid/roundId");const o=N(),r=k(o,"users",e,"rounds",s),l=k(o,"users",e,"meta","roundsIndex");try{n&&n.trim().length>0?await S(r,{folder:n.trim()}):await S(r,{folder:M()})}catch{}try{n&&n.trim().length>0?await S(l,{[`entries.${s}.folder`]:n.trim()}):await S(l,{[`entries.${s}.folder`]:M()})}catch{n&&n.trim().length>0&&await _(l,{entries:{[s]:{folder:n.trim()}}},{merge:!0})}try{const i=await D(e);if(i?.entries){const a={...i.entries};if(a[s]||(a[s]={}),n&&n.trim().length>0)a[s]={...a[s],folder:n.trim()};else{const{folder:d,...u}=a[s];a[s]=u}await R(e,{entries:a,updatedAt:Date.now()})}const c=await te(e,s);if(c&&c.data){const a={...c.data};n&&n.trim().length>0?a.folder=n.trim():delete a.folder,await U(e,s,{data:a,updatedAt:Date.now()})}}catch{}return!0}function rs(e){const s=new Set,n=e?.pairs||[];for(const o of n)o.tossupId&&s.add(o.tossupId),o.bonusId&&s.add(o.bonusId);return s}async function ns(e,s,n){if(!e)throw new Error("Not authenticated");if(!s)throw new Error("Missing roundId");const o=(n??"").toString().trim();if(o.length===0)throw new Error("Title cannot be empty");const r=N(),l=k(r,"users",e,"rounds",s);await S(l,{title:o});const i=k(r,"users",e,"meta","roundsIndex");try{await S(i,{[`entries.${s}.title`]:o})}catch{await _(i,{entries:{[s]:{title:o}}},{merge:!0})}try{const c=await D(e);c&&c.entries&&c.entries[s]&&(c.entries[s]={...c.entries[s],title:o},await R(e,{...c,updatedAt:Date.now()}));const a=await te(e,s);if(a&&a.data){const d={...a,data:{...a.data,title:o},updatedAt:Date.now()};await U(e,s,d)}}catch{}return!0}function ue(){const[e,s]=w.useState(null),[n,o]=w.useState(!0),[r,l]=w.useState(null);w.useEffect(()=>{const u=T(),m=xe(u,f=>{s(f),o(!1)},f=>{l(f),o(!1)});return()=>m()},[]);const i=w.useCallback(async()=>{const u=T(),m=new be;await ye(u,m)},[]),c=w.useCallback(async(u,m)=>{const f=T();await je(f,u,m)},[]),a=w.useCallback(async(u,m)=>{const f=T();await ve(f,u,m)},[]),d=w.useCallback(async()=>{const u=T(),m=u.currentUser?.uid;await ke(u),m&&await Je(m)},[]);return{user:e,loading:n,error:r,loginWithGoogle:i,loginWithEmail:c,signupWithEmail:a,logout:d}}function Ke(){const e={"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:[{"@type":"ListItem",position:1,name:"Home",item:"https://sciencebowl.org/"},{"@type":"ListItem",position:2,name:"Round Generator",item:"https://sciencebowl.org/round-generator"}]};return t.jsxs(Y,{children:[t.jsx("title",{children:"Round Generator & Practice | DA SciBowl"}),t.jsx("meta",{name:"description",content:"Generate custom Science Bowl practice rounds instantly. Filter by tournament, practice toss-ups and bonuses, and prepare for competitions."}),t.jsx("link",{rel:"canonical",href:"https://sciencebowl.org/round-generator"}),t.jsx("script",{type:"application/ld+json",children:JSON.stringify(e)})]})}function Xe(){const e={"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:[{"@type":"ListItem",position:1,name:"Home",item:"https://sciencebowl.org/"},{"@type":"ListItem",position:2,name:"Practice",item:"https://sciencebowl.org/practice"}]};return t.jsxs(Y,{children:[t.jsx("title",{children:"Science Bowl Practice Mode | Davidson Science Bowl"}),t.jsx("meta",{name:"description",content:"Practice Science Bowl questions by selecting tournaments and generating custom practice sets."}),t.jsx("link",{rel:"canonical",href:"https://sciencebowl.org/practice"}),t.jsx("script",{type:"application/ld+json",children:JSON.stringify(e)}),t.jsx("meta",{name:"robots",content:"follow"})]})}function Ye(){return t.jsxs(Y,{children:[t.jsx("title",{children:"Sign In | Science Bowl Practice"}),t.jsx("meta",{name:"robots",content:"noindex,nofollow"}),t.jsx("meta",{name:"description",content:"Sign in to access Science Bowl round generation and practice features."}),t.jsx("link",{rel:"canonical",href:"https://sciencebowl.org/signin"})]})}const Ze=w.lazy(()=>Z(()=>import("./PracticeMode-CQy9BS23.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46]))),et=w.lazy(()=>Z(()=>import("./Admin-BewFQqRd.js"),__vite__mapDeps([47,1,2,17,7,8,9,10,11,18,3,4,5,6,14,15,16,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,13]))),tt=w.lazy(()=>Z(()=>import("./RoundGenerator-taxQ471E.js"),__vite__mapDeps([48,1,2,3,4,5,6,7,8,9,10,11,12,13,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,25,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,14,15,16,17,18,19,20,21,22,23,24,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46])));function st({active:e,children:s,onClick:n}){return t.jsx("button",{onClick:n,className:`btn ${e?"btn-primary":"btn-ghost"}`,"aria-pressed":e,children:s})}function K(){const e=Ue(),s=ue(),n=Be(),o=Ie(),r=n.pathname.startsWith("/practice")?"practice":n.pathname.startsWith("/admin")?"admin":"generate",[l,i]=w.useState(()=>window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches);return w.useEffect(()=>{document.documentElement.classList.toggle("dark",l),l?document.body.classList.add("dark-bg"):document.body.classList.remove("dark-bg");let c=document.querySelector('meta[name="theme-color"]');c||(c=document.createElement("meta"),c.setAttribute("name","theme-color"),document.head.appendChild(c)),c.setAttribute("content",l?"#000000":"#ffffff")},[l]),w.useEffect(()=>{try{const c="admin-border-on",a=document.body,d=document.documentElement;return r==="admin"?(a.classList.add(c),d.classList.add(c)):(a.classList.remove(c),d.classList.remove(c)),()=>{a.classList.remove(c),d.classList.remove(c)}}catch{}},[r]),t.jsxs("div",{className:"min-h-screen app-radial-bg dark:app-radial-bg transition-colors glass-backdrop",children:[t.jsx("style",{children:`
    html.admin-border-on::before, body.admin-border-on::before {
      content: "";
      position: fixed;
      inset: 0;
      pointer-events: none;
      box-shadow: inset 0 0 0 6px #dc2626;
      z-index: 2147483647; /* max to sit above app */
    }
    @media (max-width: 480px) {
      html.admin-border-on::before, body.admin-border-on::before {
        box-shadow: inset 0 0 0 4px #dc2626;
      }
    }
  `}),r==="practice"?t.jsx(Xe,{}):t.jsx(Ke,{}),t.jsx("header",{className:"header-bar",children:t.jsxs("div",{className:"w-full px-4 py-3 flex items-center justify-between",children:[t.jsxs("div",{className:"brand-cluster",children:[t.jsx("img",{src:"/logo.png",alt:"Davidson Science Bowl Logo",className:"w-8 h-8 rounded-lg"}),t.jsx("div",{className:"font-semibold tracking-tight",style:{color:"#550000"},children:"Davidson Science Bowl"})]}),t.jsxs("nav",{className:"flex items-center gap-2",children:[t.jsx(st,{active:r==="practice",onClick:()=>o("/practice"),children:"Practice"}),t.jsx("button",{onClick:()=>o("/round-generator"),className:"btn btn-top-maroon ","aria-pressed":r==="generate",children:"Round Generator"}),s?.user?.uid==="fkLJJ2R6HbdwqoXSxrLUybZ0IdH2"&&t.jsxs("button",{onClick:()=>{try{document.body.classList.add("admin-border-on"),document.documentElement.classList.add("admin-border-on")}catch{}o("/admin")},className:"btn inline-flex items-center gap-2 font-semibold text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500","aria-pressed":r==="admin",title:"Admin editor",children:[t.jsx($e,{size:18,className:"text-white"}),t.jsx("span",{className:"text-white",children:"Admin"})]}),t.jsx("div",{className:"ml-4",children:t.jsx(le,{checked:l,onChange:i})}),t.jsx("div",{className:"ml-3",children:s.loading?t.jsx("div",{className:"text-sm opacity-70",children:"Loading…"}):s.user?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm opacity-80 max-w-[12rem] truncate",children:s.user.email||s.user.displayName}),t.jsx("button",{className:"btn btn-ghost",onClick:s.logout,children:"Logout"})]}):t.jsx(ce,{to:"/signin",className:"btn btn-primary",children:"Sign in"})})]})]})}),t.jsxs("main",{className:"w-full px-4 py-8 text-black dark:text-white",children:[e.loadingTournaments&&t.jsx("div",{className:"glass p-6",children:"Loading tournaments…"}),e.errorTournaments&&t.jsxs("div",{className:"glass p-6 text-red-600",children:["Failed to load tournaments: ",String(e.errorTournaments)]}),!e.loadingTournaments&&!e.errorTournaments&&t.jsx("div",{className:"space-y-6",children:t.jsx(w.Suspense,{fallback:t.jsx("div",{className:"glass p-6",children:"Loading…"}),children:r==="practice"?t.jsx(Ze,{lazy:e}):r==="admin"?t.jsx(et,{auth:s}):t.jsx(tt,{lazy:e,auth:s})})})]}),t.jsxs("footer",{className:"w-full px-4 pb-8 text-center text-black/60 dark:text-white/60",children:[!1,t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{children:"Built with Firebase • Vite • Tailwind"}),t.jsxs("div",{className:"text-xs flex flex-wrap gap-2 justify-center","aria-label":"Legal and policy links",children:[t.jsx("a",{href:"/terms-of-service",className:"hover:underline focus:outline-none focus:ring-1 focus:ring-current",rel:"nofollow",children:"Terms of Service"}),t.jsx("span",{"aria-hidden":"true",children:"•"}),t.jsx("a",{href:"/privacy-policy",className:"hover:underline focus:outline-none focus:ring-1 focus:ring-current",rel:"nofollow",children:"Privacy Policy"})]})]})]})]})}function X({children:e,dark:s,setDark:n}){return t.jsxs("div",{className:"min-h-screen app-radial-bg dark:app-radial-bg transition-colors glass-backdrop text-black dark:text-white flex flex-col items-center px-4 py-10",children:[t.jsxs("div",{className:"w-full max-w-md flex items-center justify-between mb-4 gap-2",children:[t.jsxs(ce,{to:"/round-generator",className:"inline-flex items-center gap-1 text-xs px-3 py-1 rounded-full border border-black/10 dark:border-white/20 hover:bg-black/5 dark:hover:bg-white/10 transition","aria-label":"Back to home",children:[t.jsx("span",{"aria-hidden":"true",className:"-ml-0.5 mr-0.5",children:"←"}),t.jsx(qe,{size:14,"aria-hidden":"true"}),t.jsx("span",{children:"Home"})]}),t.jsx(le,{checked:s,onChange:n})]}),e]})}function rt(){const e=ue(),[s,n]=C.useState(""),[o,r]=C.useState(""),[l,i]=C.useState(!1),[c,a]=C.useState(""),[d,u]=C.useState(!1),[m,f]=C.useState(""),[h,x]=C.useState(()=>window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches);C.useEffect(()=>{document.documentElement.classList.toggle("dark",h),h?document.body.classList.add("dark-bg"):document.body.classList.remove("dark-bg");let g=document.querySelector('meta[name="theme-color"]');g||(g=document.createElement("meta"),g.name="theme-color",document.head.appendChild(g)),g.setAttribute("content",h?"#000000":"#ffffff")},[h]);const A=/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(s),P=o.length>=10,O=async()=>{if(a(""),!A){a("Enter a valid email.");return}if(!P){a("Password must be at least 10 characters.");return}i(!0);try{await e.loginWithEmail(s,o)}catch(g){const p=g?.code||"";a(p==="auth/invalid-credential"||p==="auth/wrong-password"||p==="auth/user-not-found"?"Wrong email or password.":p==="auth/too-many-requests"?"Too many attempts. Try again later.":p==="auth/invalid-email"?"Enter a valid email.":g?.message||"Login failed.")}finally{i(!1)}},G=async()=>{if(a(""),!A){a("Enter a valid email.");return}if(!P){a("Password isn’t safe. Use at least 10 characters.");return}i(!0);try{await e.signupWithEmail(s,o)}catch(g){const p=g?.code||"";a(p==="auth/email-already-in-use"?"That email already exists. Try signing in.":p==="auth/weak-password"?"Password isn’t safe. Use at least 10 characters.":p==="auth/invalid-email"?"Enter a valid email.":g?.message||"Sign up failed.")}finally{i(!1)}},H=async()=>{a(""),i(!0);try{await e.loginWithGoogle()}catch(g){const p=g?.code||"";a(p==="auth/popup-closed-by-user"?"Sign-in was canceled.":p==="auth/cancelled-popup-request"?"Another sign-in is already in progress.":g?.message||"Google sign-in failed.")}finally{i(!1)}};return e.user?t.jsx(X,{dark:h,setDark:x,children:t.jsxs("div",{className:"mx-auto w-full max-w-md p-6 glass space-y-4",children:[t.jsxs("div",{className:"mb-3",children:["You’re signed in as ",t.jsx("strong",{children:e.user.email||e.user.displayName}),"."]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("a",{href:"/",className:"btn btn-primary",children:"Go to app"}),t.jsx("button",{className:"btn btn-ghost",onClick:e.logout,children:"Logout"})]})]})}):d?t.jsx(X,{dark:h,setDark:x,children:t.jsxs("div",{className:"mx-auto w-full max-w-md p-6 glass space-y-4 flex flex-col items-center",children:[t.jsx("h1",{className:"text-xl font-semibold gradient-text",children:"Reset password"}),m&&t.jsx("div",{className:"rounded-lg border border-green-300/60 bg-green-50 text-green-800 dark:bg-green-900/20 dark:text-green-200 dark:border-green-400/40 px-3 py-2 text-sm",children:m}),c&&t.jsx("div",{className:"rounded-lg border border-red-300/60 bg-red-50 text-red-800 dark:bg-red-900/20 dark:text-red-200 dark:border-red-400/40 px-3 py-2 text-sm",children:c}),t.jsx("input",{className:"w-full rounded-lg border border-black/10 bg-white dark:bg-darkcard text-black dark:text-white px-2 py-2",placeholder:"Enter your email",type:"email",autoComplete:"email",value:s,onChange:g=>n(g.target.value)}),t.jsxs("div",{className:"flex flex-col items-center gap-2 w-full mt-2",children:[t.jsxs("button",{className:"btn btn-primary flex items-center justify-center gap-2 w-full",disabled:l||!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(s),onClick:async()=>{a(""),f(""),i(!0);try{await Se(T(),s),f("Password reset email sent, if you have an account with us! Check your inbox.")}catch(g){g?.code==="auth/user-not-found"?a("No account found for that email."):g?.code==="auth/invalid-email"?a("Enter a valid email."):a(g?.message||"Failed to send reset email.")}finally{i(!1)}},children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M22 2L11 13"}),t.jsx("path",{d:"M22 2l-7 20-4-9-9-4 20-7z"})]}),"Send reset email"]}),t.jsxs("button",{className:"btn btn-ghost flex items-center justify-center gap-2 w-full",onClick:()=>{u(!1),a(""),f("")},children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]})]})]})}):t.jsx(X,{dark:h,setDark:x,children:t.jsxs("div",{className:"mx-auto w-full max-w-md p-6 glass mt-0 space-y-4 flex flex-col items-center",children:[t.jsx(Ye,{}),t.jsx("h1",{className:"text-xl font-semibold gradient-text",children:"Sign in"}),c&&t.jsx("div",{className:"rounded-lg border border-red-300/60 bg-red-50 text-red-800 dark:bg-red-900/20 dark:text-red-200 dark:border-red-400/40 px-3 py-2 text-sm",role:"alert","aria-live":"polite",children:c}),t.jsxs("button",{className:"btn btn-google w-full bg-white text-[#1f1f1f] border border-black/10 hover:bg-white/90 dark:bg-white dark:text-[#1f1f1f] dark:hover:bg-white/90 flex items-center justify-center text-base",style:{maxWidth:320,minHeight:48,paddingTop:8,paddingBottom:8},disabled:l,onClick:H,children:[t.jsx("span",{className:"google-icon",style:{width:28,height:28,marginRight:14,display:"flex",alignItems:"center",justifyContent:"center"},"aria-hidden":!0}),t.jsx("span",{style:{lineHeight:"28px"},children:"Sign in with Google"})]}),t.jsx("div",{className:"text-center opacity-60 text-sm",children:"or"}),t.jsx("input",{className:"w-full rounded-lg border border-black/10 bg-white dark:bg-darkcard text-black dark:text-white px-2 py-2",placeholder:"email",type:"email",autoComplete:"email",value:s,onChange:g=>n(g.target.value)}),t.jsx("input",{className:"w-full rounded-lg border border-black/10 bg-white dark:bg-darkcard text-black dark:text-white px-2 py-2",placeholder:"password",type:"password",autoComplete:"current-password",value:o,onChange:g=>r(g.target.value)}),t.jsxs("div",{className:"flex flex-col w-full mt-2 gap-2 items-center",children:[t.jsxs("div",{className:"flex gap-2 w-full justify-center",children:[t.jsxs("button",{className:"btn btn-fancy flex items-center justify-center gap-2 text-sm font-medium",disabled:l,onClick:O,children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14M12 5l7 7-7 7"})}),"Login"]}),t.jsxs("button",{className:"btn btn-orange flex items-center justify-center gap-2 text-sm font-medium hover-lift",disabled:l,onClick:G,children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Sign up"]})]}),t.jsx("button",{className:"text-xs text-red-500 hover:underline focus:underline font-normal w-full mt-2 flex items-center justify-center gap-1 bg-transparent border-none p-0",type:"button",style:{cursor:"pointer"},onClick:()=>{u(!0),a(""),f("")},children:"Forgot password?"})]})]})})}const nt=Oe([{path:"/",element:t.jsx(Te,{to:"/round-generator",replace:!0})},{path:"/round-generator",element:t.jsx(K,{})},{path:"/practice",element:t.jsx(K,{})},{path:"/admin",element:t.jsx(K,{})},{path:"/signin",element:t.jsx(rt,{})}]);ge.createRoot(document.getElementById("root")).render(t.jsx(C.StrictMode,{children:t.jsx(Me,{children:t.jsx(_e,{router:nt})})}));export{Z as _,Yt as a,ns as b,Jt as c,Xt as d,ts as e,es as f,N as g,Kt as h,rs as i,Qt as j,Vt as k,Zt as r,ss as s};
