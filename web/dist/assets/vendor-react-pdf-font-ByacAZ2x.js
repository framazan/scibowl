import{f as p}from"./vendor-cross-fetch-DvOI2u39.js";import{$ as g}from"./vendor-fontkit-5mDwoQ7O.js";const b={thin:100,hairline:100,ultralight:200,extralight:200,light:300,normal:400,medium:500,semibold:600,demibold:600,bold:700,ultrabold:800,extrabold:800,heavy:900,black:900},F=async(i,o)=>{const e=await(await p(i,o)).arrayBuffer();return new Uint8Array(e)},W=i=>{const o=i.split(",")[0],s=o.substring(0,5)==="data:",e=o.split(";")[1]==="base64";return s&&e},S=i=>typeof i=="string"?b[i]:i,m=(i,o)=>i.fontWeight-o.fontWeight;class w{constructor(o,s,e,t,n){this.src=o,this.fontFamily=s,this.fontStyle=e||"normal",this.fontWeight=t||400,this.data=null,this.options=n,this.loadResultPromise=null}async _load(){const{postscriptName:o}=this.options;if(W(this.src)){const s=this.src.split(",")[1],e=new Uint8Array(atob(s).split("").map(t=>t.charCodeAt(0)));this.data=g(e,o)}else{const{headers:s,body:e,method:t="GET"}=this.options,n=await F(this.src,{method:t,body:e,headers:s});this.data=g(n,o)}}async load(){return this.loadResultPromise===null&&(this.loadResultPromise=this._load()),this.loadResultPromise}}class f{static create(o){return new f(o)}constructor(o){this.family=o,this.sources=[]}register(o){let{src:s,fontWeight:e,fontStyle:t,...n}=o;const l=S(e);this.sources.push(new w(s,this.family,t,l,n))}resolve(o){const{fontWeight:s=400,fontStyle:e="normal"}=o,t=this.sources.filter(r=>r.fontStyle===e),n=t.find(r=>r.fontWeight===s);if(n)return n;let l;if(s>=400&&s<=500){const r=t.filter(h=>h.fontWeight<=s),u=t.filter(h=>h.fontWeight>500);l=t.filter(h=>h.fontWeight>=s&&h.fontWeight<500)[0]||r[r.length-1]||u[0]}const a=t.filter(r=>r.fontWeight<s).sort(m),c=t.filter(r=>r.fontWeight>s).sort(m);if(s<400&&(l=a[a.length-1]||c[0]),s>500&&(l=c[0]||a[a.length-1]),!l)throw new Error("Could not resolve font for "+this.family+", fontWeight "+s);return l}}var y=["Courier","Courier-Bold","Courier-Oblique","Courier-BoldOblique","Helvetica","Helvetica-Bold","Helvetica-Oblique","Helvetica-BoldOblique","Times-Roman","Times-Bold","Times-Italic","Times-BoldItalic"];function O(){let i={},o=null,s=null;this.register=e=>{const{family:t}=e;if(i[t]||(i[t]=f.create(t)),e.fonts)for(let n=0;n<e.fonts.length;n+=1)i[t].register({family:t,...e.fonts[n]});else i[t].register(e)},this.registerEmojiSource=e=>{let{url:t,format:n="png",builder:l,withVariationSelectors:a=!1}=e;o={url:t,format:n,builder:l,withVariationSelectors:a}},this.registerHyphenationCallback=e=>{s=e},this.getFont=e=>{const{fontFamily:t}=e;if(y.includes(t))return null;if(!i[t])throw new Error("Font family not registered: "+t+". Please register it calling Font.register() method.");return i[t].resolve(e)},this.load=async e=>{const{fontFamily:t}=e,n=typeof t=="string"?[t]:[...t||[]],l=[];for(let a=n.length,c=0;c<a;c+=1){const r=n[c];if(y.includes(r))return;const d=this.getFont({...e,fontFamily:r});l.push(d.load())}await Promise.all(l)},this.reset=()=>{const e=Object.keys(i);for(let t=0;t<e.length;t+=1){const n=e[t];i[n].data=null}},this.clear=()=>{i={}},this.getRegisteredFonts=()=>i,this.getEmojiSource=()=>o,this.getHyphenationCallback=()=>s,this.getRegisteredFontFamilies=()=>Object.keys(i)}export{O as F};
